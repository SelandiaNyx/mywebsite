<!DOCTYPE html>
<html lang="zh-Hans">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arch Linux å®‰è£…æ•™ç¨‹</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
	<header>
        <h1>Arch Linux å®‰è£…æ•™ç¨‹</h1>
        <p>å‘å¸ƒæ—¥æœŸ: 2024å¹´9æœˆ28æ—¥</p>
    </header>
    <section>
        <h2>ç”µè„‘é…ç½®</h2>
        <ul>
            <li><strong>CPU</strong>: 12th Gen Intel(R) Core(TM) i5-12600K (10) @ 5.30 GHz</li>
            <li><strong>GPU 1</strong>: NVIDIA GeForce RTX 4080 SUPER [Discrete]</li>
            <li><strong>GPU 2</strong>: Intel AlderLake-S GT1 @ 1.45 GHz [Integrated]</li>
        </ul>
    </section>
    <section>
		<h2>äº‹å‰å‡†å¤‡</h2>
		<h3>ä¸‹è½½ ISO é•œåƒ</h3>
		<ul>
			<li><strong>å®˜ç½‘é“¾æ¥</strong>: <a href="https://archlinux.org/download/" target="_blank" rel="noopener noreferrer">ğŸ”—Arch Linux ä¸‹è½½å®˜ç½‘</a></li>
		</ul>
		<h3>åˆ»å½• U ç›˜</h3>
		<ul>
			<li><strong>æ¨èä½¿ç”¨ rufusï¼Œç®€å•æ˜“æ“ä½œ</strong></li>
		</ul>
		<h3>BIOS è®¾ç½® U ç›˜å¯åŠ¨</h3>
		<ul>
			<li><strong>è¿›å…¥ BIOS åæ‰¾åˆ°å¯åŠ¨è®¾ç½®ï¼Œè°ƒæ•´ä¸ºä» U ç›˜å¯åŠ¨</strong></li>
		</ul>
    </section>
    <section>
		<h2>æ­£å¼å®‰è£…</h2>
		<ol>
			<li><strong>è¿æ¥æ— çº¿ç½‘ç»œ</strong>
                <pre><code>iwctl                                       #æ‰§è¡Œiwctlå‘½ä»¤ï¼Œè¿›å…¥äº¤äº’å¼å‘½ä»¤è¡Œ
device list                                 #åˆ—å‡ºè®¾å¤‡åï¼Œæ¯”å¦‚æ— çº¿ç½‘å¡çœ‹åˆ°å« wlan0
station wlan0 scan                          #æ‰«æç½‘ç»œ
station wlan0 get-networks                  #åˆ—å‡ºç½‘ç»œ æ¯”å¦‚æƒ³è¿æ¥YOUR-WIRELESS-NAMEè¿™ä¸ªæ— çº¿
station wlan0 connect YOUR-WIRELESS-NAME    #è¿›è¡Œè¿æ¥ è¾“å…¥å¯†ç å³å¯
exit                                        #æˆåŠŸåexité€€å‡º
ping wwww.baidu.com                         #æµ‹è¯•ç½‘ç»œè¿é€šæ€§</code></pre>
			</li>
            <li><strong>æ›´æ–°ç³»ç»Ÿæ—¶é’Ÿ</strong>
				<pre><code>timedatectl set-ntp true                    #å°†ç³»ç»Ÿæ—¶é—´ä¸ç½‘ç»œæ—¶é—´è¿›è¡ŒåŒæ­¥
timedatectl status                          #æ£€æŸ¥æœåŠ¡çŠ¶æ€</code></pre>
			</li>
			<li><strong>åˆ†åŒº</strong>
				<pre><code>lsblk                                       #æ˜¾ç¤ºåˆ†åŒºæƒ…å†µ æ‰¾åˆ°ä½ æƒ³å®‰è£…çš„ç£ç›˜åç§°
parted /dev/nvme0n1                         #æ‰§è¡Œpartedï¼Œè¿›å…¥äº¤äº’å¼å‘½ä»¤è¡Œï¼Œè¿›è¡Œç£ç›˜ç±»å‹å˜æ›´
(parted)mktable                             #è¾“å…¥mktable
New disk label type? gpt                    #è¾“å…¥gpt å°†ç£ç›˜ç±»å‹è½¬æ¢ä¸ºgpt å¦‚ç£ç›˜æœ‰æ•°æ®ä¼šè­¦å‘Šï¼Œè¾“å…¥yeså³å¯
quit                                        #æœ€åquité€€å‡ºpartedå‘½ä»¤è¡Œäº¤äº’
cfdisk /dev/nvme0n1                         #å…ˆé€‰æ‹© new æ¨¡å¼æ–°å»º EFI åˆ†åŒºï¼Œå¤§å°å»ºè®®å¤§äºç­‰äº 256MB,åˆ é™¤å¹¶è¾“å…¥ 256M å³å¯ï¼Œæ–°å»º EFI åˆ†åŒºåé€‰æ‹©æ­¤åˆ†åŒºï¼Œå¹¶é€‰æ‹© TYPEï¼Œè¿›å…¥åé€‰æ‹©é€‰æ‹© EFI System ç±»å‹ã€‚éšååˆ›å»º swap åˆ†åŒºï¼Œå¤§å°å»ºè®®å¤§äºç­‰äºä½ çš„å†…å­˜å¤§å°ï¼Œç±»å‹é€‰æ‹© Linux swapã€‚å‰©ä½™å¤§å°å…¨éƒ¨ç”¨äºåˆ›å»º / åˆ†åŒºï¼Œé»˜è®¤é€‰æ‹©Linux filesystemç±»å‹ã€‚æœ€åé€‰æ‹© writeï¼Œå›è½¦åè¾“å…¥ yes å†æ¬¡å›è½¦ï¼Œåˆ†åŒºç»“æŸ
fdisk -l                                    #åˆ†åŒºç»“æŸåï¼Œ å¤æŸ¥ç£ç›˜æƒ…å†µ</code></pre>
			</li>
			<li><strong>æ ¼å¼åŒ–</strong>
				<pre><code>mkfs.fat -F 32 /dev/nvme0n1p1               #æ ¼å¼åŒ–efiåˆ†åŒº
mkswap /dev/nvme0n1p2                       #æ ¼å¼åŒ–swapåˆ†åŒº
mkfs.btrfs /dev/nvme0n1p3                   #æ ¼å¼åŒ–/åˆ†åŒº</code></pre>
			</li>
			<li><strong>æŒ‚è½½</strong>
            <pre><code>æŒ‰é¡ºåºæ¥ï¼Œé¿å…å‡ºé”™
é¦–å…ˆåˆ›å»ºå­å·ï¼Œå°† / åˆ†åŒºæŒ‚è½½åˆ° /mnt ä¸‹
mount -t btrfs -o compress=zstd /dev/nvme0n1p3 /mnt
btrfs subvolume create /mnt/@               #åˆ›å»º/ç›®å½•å­å·
btrfs subvolume create /mnt/@home           #åˆ›å»º/homeç›®å½•å­å·
umount /mnt                                 #å¸è½½/mnt
æ­£å¼æŒ‚è½½
mount -t btrfs -o subvol=/@,compress=zstd /dev/nvme0n1p3 /mnt #æŒ‚è½½/ç›®å½•
mkdir /mnt/home                             #åˆ›å»º/homeç›®å½•
mount -t btrfs -o subvol=/@home,compress=zstd /dev/nvme0n1p3 /mnt/home # æŒ‚è½½/homeç›®å½•
mkdir -p /mnt/boot                          #åˆ›å»º/bootç›®å½•
mount /dev/nvme0n1p1 /mnt/boot              #æŒ‚è½½/bootç›®å½•
swapon /dev/nvme0n1p2                       #æŒ‚è½½äº¤æ¢åˆ†åŒº</code></pre>
			</li>
			<li><strong>å®‰è£…ç³»ç»Ÿ</strong>
            <pre><code>å…ˆä¿®æ”¹ pacman é…ç½®æ–‡ä»¶ï¼Œé¿å…é¾Ÿé€Ÿä¸‹è½½
vim /etc/pacman.conf
åˆ æ‰ # ParalleDownloads = 5 å‰é¢çš„ #ï¼Œå¼€å¯å¹¶è¡Œä¸‹è½½
vim /etc/pacman.d/mirrorlist
åœ¨æœ€ä¸Šé¢æ·»åŠ 
Server = https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch	#è¿™æ˜¯ä¸­ç§‘å¤§é•œåƒç«™ï¼Œå…¶ä»–é•œåƒç«™ä¹Ÿè¡Œ
pacstrap /mnt base base-devel linux-zen linux-zen-headers linux-firmware btrfs-progs  #è¿™é‡Œä¸ºäº†æ€§èƒ½æˆ‘é€‰æ‹©zenå†…æ ¸ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©å…¶å®ƒå†…æ ¸</code></pre>
			</li>
			<li><strong>å®‰è£…å…¶å®ƒå¿…è¦çš„åŠŸèƒ½æ€§è½¯ä»¶</strong>
            <pre><code>pacstrap /mnt networkmanager vim sudo bash bash-completion	#ä¼šzshçš„æŠŠbashæ¢æˆzshå°±å¥½äº†</code></pre>
			</li>
			<li><strong>ç”Ÿæˆ fstab æ–‡ä»¶</strong>
            <pre><code>genfstab -U /mnt >> /mnt/etc/fstab	#wikiå†™æ³•ï¼Œä½ å¯èƒ½çœ‹è¿‡åˆ«çš„æ•™ç¨‹å¹¶ä¸”å†™æ³•ä¸ä¸€æ ·ï¼Œä¸ºäº†é¿å…å‡ºé”™æˆ‘æ¨èä½¿ç”¨wikiå†™æ³•</code></pre>
			</li>
			<li><strong>åˆ‡æ¢ root</strong>
            <pre><code>arch-chroot /mnt	#é¢œè‰²å˜äº†å°±å¯¹äº†</code></pre>
			</li>
			<li><strong>è®¾ç½®ä¸»æœºåä¸æ—¶åŒº</strong>
            <pre><code>vim /etc/hostname                           #éšä¾¿å†™ï¼Œæ¨èå†™fucknvidiaæ¥æé†’è‡ªå·±
vim /etc/hosts                              #è®¾ç½®hosts,ä¸€èˆ¬ä¸éœ€è¦
åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼š
127.0.0.1   localhost
::1         localhost
127.0.1.1   fucknvidia.localdomain fucknvidia
ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime #åªæœ‰Shanghaiï¼Œè¯„åˆ¤æ ‡å‡†æ˜¯äººæ•°ï¼Œä¸è¦æ„Ÿåˆ°å¥‡æ€ª</code></pre>
			</li>
			<li><strong>ç¡¬ä»¶æ—¶é—´åŒæ­¥</strong>
            <pre><code>hwclock --systohc</code></pre>
			</li>
			<li><strong>è®¾ç½® Locale</strong>
            <pre><code>vim /etc/locale.gen				#å»æ‰ en_US.UTF-8 UTF-8 ä»¥åŠ zh_CN.UTF-8 UTF-8 è¡Œå‰çš„æ³¨é‡Šç¬¦å· #
vim /etc/locale.gen
locale-gen  					#ç”Ÿæˆlocale
echo 'LANG=en_US.UTF-8'  > /etc/locale.conf	#å»ºè®®åˆ«æ”¹zh_CN.UTF-8ï¼Œæ¦‚ç‡å‡ºé—®é¢˜</code></pre>
			</li>
			<li><strong>è®¾ç½® root å¯†ç </strong>
            <pre><code>passwd root	#ä¸æ˜¾ç¤ºå¯†ç ï¼Œéœ€è¦è¾“å…¥ä¸¤æ¬¡ï¼Œå‡ºç°successfullyå³ä¸ºæˆåŠŸ</code></pre>
			</li>
			<li><strong>å®‰è£…å¾®ç </strong>
            <pre><code>pacman -S intel-ucode #Intel
pacman -S amd-ucode #AMD
æ ¹æ®ä½ ç”µè„‘å®é™…æƒ…å†µé€‰æ‹©</code></pre>
			</li>
			<li><strong>å®‰è£…å¼•å¯¼ç¨‹åº</strong>
            <pre><code>pacman -S grub efibootmgr os-prober
grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=ARCH
vim /etc/default/grub
å¤šç³»ç»ŸæŠŠæœ€åä¸€è¡Œ #GRUB_DISABLE_OS_PROBER=falseå–æ¶ˆæ³¨é‡Šï¼ŒNVIDIA æ˜¾å¡ç°åœ¨å°±å¯ä»¥ä¿®æ”¹ GRUB_CMDLINE_LINUX_DEFAULT é‡Œçš„å†…å®¹ï¼ŒåŠ å…¥ nvidia-drm.modeset=1å’Œ nvidia.NVreg_PreserveVideoMemoryAllocations=1ï¼Œå‰ä¸€ä¸ªå¼€å¯ drmï¼Œåä¸€ä¸ªè®©ç³»ç»Ÿå¯ä»¥æ­£å¸¸ä¼‘çœ 
grub-mkconfig -o /boot/grub/grub.cfg    #ç”Ÿæˆgrubæ‰€éœ€çš„é…ç½®æ–‡ä»¶</code></pre>
			</li>
			<li><strong>å®Œæˆå®‰è£…</strong>
            <pre><code>exit                                    #é€€å›å®‰è£…ç¯å¢ƒ
umount -R /mnt                          #å¸è½½æ–°åˆ†åŒº
reboot                                  #é‡å¯
è®°å¾—æ‹”æ‰Uç›˜</code></pre>
			</li>
			<li><strong>å¼€å¯ç½‘ç»œè‡ªå¯åŠ¨æœåŠ¡</strong>
            <pre><code>root
è¾“å…¥ä½ åˆšæ‰è®¾ç½®çš„å¯†ç å¹¶å›è½¦
systemctl enable --now NetworkManager #è®¾ç½®å¼€æœºè‡ªå¯å¹¶ç«‹å³å¯åŠ¨NetworkManager æœåŠ¡
nmcli dev wifi list #æ˜¾ç¤ºé™„è¿‘çš„ Wi-Fi ç½‘ç»œ
nmcli dev wifi connect "Wi-Fiåï¼ˆSSIDï¼‰" password "ç½‘ç»œå¯†ç " #è¿æ¥æŒ‡å®šçš„æ— çº¿ç½‘ç»œ
ping www.baidu.com #æµ‹è¯•ç½‘ç»œè¿æ¥</code></pre>
			</li>
			<li><strong>æ‰“å°ç³»ç»Ÿä¿¡æ¯</strong>
            <pre><code>pacman -S fastfetch
fastfetch</code></pre>
			</li>
			<li><strong>é…ç½® root è´¦æˆ·çš„é»˜è®¤ç¼–è¾‘å™¨</strong>
            <pre><code>vim ~/.bash_profile
æ·»åŠ  export EDITOR='vim'</code></pre>
			</li>
			<li><strong>å‡†å¤‡é root ç”¨æˆ·</strong>
            <pre><code>useradd -m -G wheel -s /bin/bash myusername #myusernameä½ å¯ä»¥éšä¾¿å†™
passwd myusername   #å’Œå‰é¢rootä¸€æ ·
EDITOR=vim visudo #è¿™é‡Œéœ€è¦æ˜¾å¼çš„æŒ‡å®šç¼–è¾‘å™¨ï¼Œå› ä¸ºä¸Šé¢çš„ç¯å¢ƒå˜é‡è¿˜æœªç”Ÿæ•ˆ
æ‰¾åˆ° #%wheel ALL=(ALL:ALL) ALLï¼Œåˆ æ‰ #</code></pre>
			</li>
			<li><strong>å¼€å¯ 32 ä½æ”¯æŒåº“ä¸ Arch Linux ä¸­æ–‡ç¤¾åŒºä»“åº“ï¼ˆarchlinuxcnï¼‰</strong>
            <pre><code>vim /etc/pacman.conf
å»æ‰ [multilib] ä¸€èŠ‚ä¸­ä¸¤è¡Œçš„æ³¨é‡Šï¼Œæ¥å¼€å¯ 32 ä½åº“æ”¯æŒ
æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š
[archlinuxcn]
Server = https://mirrors.ustc.edu.cn/archlinuxcn/$arch #ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦å¼€æºé•œåƒç«™
pacman -Syyu</code></pre>
			</li>
			<li><strong>å®‰è£… KDE Plasma æ¡Œé¢ç¯å¢ƒåŠæ˜¾å¡é©±åŠ¨ç­‰ä¸€å †ç©æ„å„¿</strong>
            <pre><code>pacman -S plasma-meta konsole dolphin firefox ntfs-3g adobe-source-han-serif-cn-fonts wqy-zenhei noto-fonts noto-fonts-cjk noto-fonts-emoji noto-fonts-extra unzip unrar packagekit packagekit-qt6 gwenview nvidia-open-dkms nvidia-utils lib32-nvidia-utils
pacman -S archlinuxcn-keyring
pacman -S yay
AMDæ˜¾å¡å¯ä»¥ç›´æ¥ä½¿ç”¨é»˜è®¤é©±åŠ¨ï¼Œå¸¦æœ‰nvidiaå­—æ ·çš„å…¨éƒ¨å»æ‰</code></pre>
			</li>
			<li><strong>é…ç½®å¹¶å¯åŠ¨ greeter sddm</strong>
            <pre><code>systemctl enable sddm
reboot
è¾“å…¥ç”¨æˆ·å¯†ç å›è½¦ç™»å½•</code></pre>
			</li>
			<li><strong>é…ç½®é root è´¦æˆ·çš„é»˜è®¤ç¼–è¾‘å™¨</strong>
            <pre><code>vim ~/.bashrc
åŠ å…¥ export EDITOR='vim'</code></pre>
			</li>
			<li><strong>å®‰è£…è¾“å…¥æ³•</strong>
            <pre><code>å…ˆåœ¨ç³»ç»Ÿè®¾ç½®é‡Œæ‰¾åˆ° language è®¾ç½®ï¼Œé€‰ç¬¬ä¸€ä¸ª moddify å¹¶æ·»åŠ ç®€ä½“ä¸­æ–‡ï¼Œç§»åŠ¨åˆ°æœ€ä¸Šé¢ï¼Œè¿”å›ä¸Šä¸€çº§èœå•ç‚¹å‡» restart now
sudo pacman -S fcitx5-im fcitx5-chinese-addons fcitx5-pinyin-moegirl fcitx5-pinyin-sougou
mkdir ~/.config/environment.d
vim ~/.config/environment.d/im.conf
åŠ å…¥ XMODIFIERS=@im=fcitx
æ‰“å¼€ ç³»ç»Ÿè®¾ç½® > è¯­è¨€å’Œæ—¶é—´ > è¾“å…¥æ³•
ç‚¹å‡»æç¤ºä¿¡æ¯ä¸­çš„ è¿è¡Œ Fcitx
æ‰“å¼€ ç³»ç»Ÿè®¾ç½® > é”®ç›˜ > è™šæ‹Ÿé”®ç›˜
é€‰æ‹© Wayland å¯åŠ¨å™¨</code></pre>
			</li>
			<li><strong>å¼€å¯è“ç‰™</strong>
            <pre><code>sudo systemctl enable --now bluetooth</code></pre>
			</li>
			<li><strong>å…¨å±€ä»£ç†</strong>
            <pre><code>sudo pacman -S daed
sudo systemctl enable --now daed
æµè§ˆå™¨æ‰“å¼€ http://localhost:2023 æ·»åŠ è®¢é˜…å¹¶æ‹–è‡³ä»£ç†åæ‰“å¼€å³ä¸Šè§’å¼€å…³å¼€å§‹ä½¿ç”¨</code></pre>
			</li>
		</ol>
    </section>
</body>
